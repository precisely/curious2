(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 10.1' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[     60799,       1454]
NotebookOptionsPosition[     60226,       1432]
NotebookOutlinePosition[     60561,       1447]
CellTagsIndexPosition[     60518,       1444]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{

Cell[CellGroupData[{
Cell[BoxData[{
 RowBox[{
  RowBox[{"Needs", "[", "\"\<DatabaseLink`\>\"", "]"}], ";"}], "\n", 
 RowBox[{
  RowBox[{"JDBCDrivers", "[", "\"\<MySQL(Connector/J)\>\"", "]"}], 
  ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"conn", " ", "=", " ", 
    RowBox[{"OpenSQLConnection", "[", 
     RowBox[{
      RowBox[{"JDBC", "[", 
       RowBox[{
       "\"\<MySQL(Connector/J)\>\"", ",", " ", 
        "\"\<127.0.0.1:3306/tlb_dev\>\""}], "]"}], ",", " ", 
      RowBox[{"\"\<Username\>\"", " ", "->", " ", "\"\<curious\>\""}], ",", 
      " ", 
      RowBox[{"\"\<Password\>\"", " ", "->", " ", "\"\<734qf7q35\>\""}]}], 
     "]"}]}], ";"}], "\n"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"loadData", "[", 
    RowBox[{"userId_", ",", " ", "tagId_"}], "]"}], " ", ":=", " ", 
   RowBox[{
    RowBox[{"SQLExecute", "[", 
     RowBox[{"conn", ",", " ", 
      RowBox[{
      "\"\<select date from analytics_time_series where user_id=\>\"", " ", "<>",
        " ", 
       RowBox[{"ToString", "[", "userId", "]"}], " ", "<>", " ", 
       "\"\< and tag_id=\>\"", " ", "<>", " ", 
       RowBox[{"ToString", "[", "tagId", "]"}]}]}], "]"}], "[", 
    RowBox[{"[", 
     RowBox[{"All", ",", " ", "1", ",", " ", "1"}], "]"}], "]"}]}], 
  "\n"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"loadBoundaryPoints", "[", 
    RowBox[{"userId_", ",", " ", "tagId_", ",", "  ", "type_"}], "]"}], ":=", 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"SQLExecute", "[", 
     RowBox[{"conn", ",", " ", 
      RowBox[{
      "\"\<select date from analytics_boundary where user_id=\>\"", " ", "<>",
        " ", 
       RowBox[{"ToString", "[", "userId", "]"}], " ", "<>", " ", 
       "\"\< and tag_id=\>\"", " ", "<>", " ", 
       RowBox[{"ToString", "[", "tagId", "]"}], " ", "<>", " ", 
       "\"\< and type=\>\"", " ", "<>", " ", 
       RowBox[{"ToString", "[", "type", "]"}]}]}], "]"}], "[", 
    RowBox[{"[", 
     RowBox[{"All", ",", " ", "1", ",", " ", "1"}], "]"}], "]"}]}], 
  "\n"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"loadStartPoints", "[", 
   RowBox[{"userId_", ",", " ", "tagId_"}], "]"}], " ", ":=", " ", 
  RowBox[{"loadBoundaryPoints", "[", 
   RowBox[{"userId", ",", " ", "tagId", ",", " ", "1"}], 
   "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"loadStopPoints", "[", 
    RowBox[{"userId_", ",", " ", "tagId_"}], "]"}], " ", ":=", " ", 
   RowBox[{"loadBoundaryPoints", "[", 
    RowBox[{"userId", ",", " ", "tagId", ",", " ", "2"}], "]"}]}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"binDaily", "[", 
    RowBox[{"userId_", ",", " ", "tagId_"}], "]"}], " ", ":=", " ", 
   RowBox[{
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"#", "[", 
        RowBox[{"[", "1", "]"}], "]"}], ",", " ", 
       RowBox[{"Length", "@", "#"}]}], "}"}], " ", "&"}], " ", "/@", " ", 
    RowBox[{"Sort", "@", 
     RowBox[{"Gather", "[", 
      RowBox[{
       RowBox[{"loadData", "[", 
        RowBox[{"userId", ",", " ", "tagId"}], "]"}], "[", 
       RowBox[{"[", 
        RowBox[{"All", ",", " ", 
         RowBox[{";;", " ", "3"}]}], "]"}], "]"}], "]"}]}]}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{"userIds", " ", "=", " ", 
   RowBox[{"Sort", "[", 
    RowBox[{
     RowBox[{"SQLExecute", "[", 
      RowBox[{"conn", ",", " ", "\"\<select id from _user\>\""}], "]"}], "[", 
     
     RowBox[{"[", " ", 
      RowBox[{"All", ",", "1"}], "]"}], "]"}], "]"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"tagIds", " ", "=", "\[IndentingNewLine]", 
    RowBox[{"Map", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"Sort", "[", 
        RowBox[{
         RowBox[{"SQLExecute", "[", 
          RowBox[{"conn", ",", " ", 
           RowBox[{
           "\"\<select tag_id, count(*) c from analytics_time_series ts where \
ts.user_id = \>\"", " ", "<>", " ", 
            RowBox[{"ToString", "[", "#", "]"}], " ", "<>", " ", 
            "\"\< group by tag_id having c> 10\>\""}]}], "]"}], "[", 
         RowBox[{"[", 
          RowBox[{"All", ",", " ", "1"}], "]"}], "]"}], "]"}], " ", "&"}], 
      ",", " ", "userIds"}], "]"}]}], ";"}], "\[IndentingNewLine]"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"nextTag", "[", "]"}], " ", ":=", "\n", "   ", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"pos", ",", " ", 
        RowBox[{"tids", "=", 
         RowBox[{"tagIdsForUser", "[", "userId", "]"}]}]}], "}"}], ",", " ", 
      "\n", "          ", 
      RowBox[{
       RowBox[{"pos", " ", "=", " ", 
        RowBox[{"First", "[", 
         RowBox[{"First", "[", 
          RowBox[{"Position", "[", 
           RowBox[{"tids", ",", " ", "tagId"}], "]"}], "]"}], "]"}]}], ";", 
       "\n", "          ", 
       RowBox[{"tids", "[", 
        RowBox[{"[", 
         RowBox[{
          RowBox[{"Mod", "[", 
           RowBox[{"pos", ",", " ", 
            RowBox[{"Length", "[", "tids", "]"}]}], "]"}], " ", "+", " ", 
          "1"}], "]"}], "]"}]}]}], "]"}]}], ";"}], 
  "\n"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"previousTag", "[", "]"}], " ", ":=", "\n", "   ", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"pos", ",", " ", 
        RowBox[{"tids", "=", 
         RowBox[{"tagIdsForUser", "[", "userId", "]"}]}]}], "}"}], ",", " ", 
      "\n", "          ", 
      RowBox[{
       RowBox[{"pos", " ", "=", " ", 
        RowBox[{"First", "[", 
         RowBox[{"First", "[", 
          RowBox[{"Position", "[", 
           RowBox[{"tids", ",", " ", "tagId"}], "]"}], "]"}], "]"}]}], ";", 
       "\n", "          ", 
       RowBox[{"tids", "[", 
        RowBox[{"[", 
         RowBox[{
          RowBox[{"Mod", "[", 
           RowBox[{
            RowBox[{"pos", "-", "2"}], ",", " ", 
            RowBox[{"Length", "[", "tids", "]"}]}], "]"}], " ", "+", " ", 
          "1"}], "]"}], "]"}]}]}], "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"tagIdsForUser", "[", "userId_", "]"}], " ", ":=", " ", 
    RowBox[{"tagIds", "[", 
     RowBox[{"[", 
      RowBox[{"First", "[", 
       RowBox[{"First", "[", 
        RowBox[{"Position", "[", 
         RowBox[{"userIds", ",", " ", "userId"}], "]"}], "]"}], "]"}], "]"}], 
     "]"}]}], ";"}], "\[IndentingNewLine]"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"boundaryMarker", "[", "b_", "]"}], " ", ":=", " ", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"b", "[", 
      RowBox[{"[", 
       RowBox[{";;", "3"}], "]"}], "]"}], ",", " ", "maxHeight"}], "}"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"makeStartMarkers", "[", "]"}], " ", ":=", " ", 
   RowBox[{"Join", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{
         RowBox[{"DateList", "[", "tStart", "]"}], "[", 
         RowBox[{"[", 
          RowBox[{";;", "3"}], "]"}], "]"}], ",", "maxHeight"}], "}"}], "}"}],
      ",", " ", 
     RowBox[{"Map", "[", 
      RowBox[{"boundaryMarker", ",", " ", "startPoints"}], "]"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"makeStopMarkers", "[", "]"}], " ", ":=", " ", 
    RowBox[{"Join", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{
          RowBox[{"DateList", "[", "tStop", "]"}], "[", 
          RowBox[{"[", 
           RowBox[{";;", "3"}], "]"}], "]"}], ",", " ", "maxHeight"}], "}"}], 
       "}"}], ",", " ", 
      RowBox[{"Map", "[", 
       RowBox[{"boundaryMarker", ",", " ", "stopPoints"}], "]"}]}], "]"}]}], 
   ";"}], "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"refreshBoundaries", "[", 
     RowBox[{"userId_", ",", " ", "tagId_"}], "]"}], " ", ":=", " ", 
    RowBox[{"(", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"startPoints", " ", "=", " ", 
       RowBox[{"loadStartPoints", "[", 
        RowBox[{"userId", ",", "tagId"}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"stopPoints", " ", "=", " ", 
       RowBox[{"loadStopPoints", "[", 
        RowBox[{"userId", ",", "tagId"}], "]"}]}], ";"}], 
     "\[IndentingNewLine]", ")"}]}], ";"}], "\[IndentingNewLine]"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"refresh", "[", "]"}], " ", ":=", " ", 
    RowBox[{"(", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"message", "=", 
       RowBox[{
       "\"\<Refreshed chart (userId, tagId) = (\>\"", " ", "<>", " ", 
        RowBox[{"ToString", "[", "userId", "]"}], " ", "<>", " ", 
        "\"\<, \>\"", " ", "<>", " ", 
        RowBox[{"ToString", "[", "tagId", "]"}], " ", "<>", " ", 
        "\"\<)\>\""}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"bins", " ", "=", " ", 
       RowBox[{"binDaily", "[", 
        RowBox[{"userId", ",", " ", "tagId"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"maxHeight", " ", "=", " ", 
       RowBox[{"2", "*", 
        RowBox[{"Max", "[", 
         RowBox[{"bins", "[", 
          RowBox[{"[", 
           RowBox[{"All", ",", " ", "2"}], "]"}], "]"}], "]"}]}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"minSeconds", " ", "=", " ", 
       RowBox[{"Min", "[", 
        RowBox[{"AbsoluteTime", "/@", " ", 
         RowBox[{"bins", "[", 
          RowBox[{"[", 
           RowBox[{"All", ",", " ", "1"}], "]"}], "]"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"maxSeconds", " ", "=", " ", 
       RowBox[{"Max", "[", 
        RowBox[{"AbsoluteTime", "/@", " ", 
         RowBox[{"bins", "[", 
          RowBox[{"[", 
           RowBox[{"All", ",", " ", "1"}], "]"}], "]"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"tStart", " ", "=", " ", "minSeconds"}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"tStop", " ", "=", " ", "maxSeconds"}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"minDate", " ", "=", " ", 
       RowBox[{
        RowBox[{"DateList", "[", "minSeconds", "]"}], "[", 
        RowBox[{"[", 
         RowBox[{";;", "3"}], "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"maxDate", " ", "=", " ", 
       RowBox[{
        RowBox[{"DateList", "[", "maxSeconds", "]"}], "[", 
        RowBox[{"[", 
         RowBox[{";;", "3"}], "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"firstDate", " ", "=", " ", 
       RowBox[{
        RowBox[{"DateList", "[", 
         RowBox[{"minDate", " ", "-", " ", 
          RowBox[{"{", 
           RowBox[{"0", ",", " ", "0", ",", " ", "10"}], "}"}]}], "]"}], "[", 
        
        RowBox[{"[", 
         RowBox[{";;", "3"}], "]"}], "]"}]}], ";", " ", "\[IndentingNewLine]", 
      RowBox[{"lastDate", " ", "=", " ", 
       RowBox[{
        RowBox[{"DateList", "[", 
         RowBox[{"maxDate", " ", "+", " ", 
          RowBox[{"{", 
           RowBox[{"0", ",", " ", "0", ",", " ", "10"}], "}"}]}], "]"}], "[", 
        
        RowBox[{"[", 
         RowBox[{";;", "3"}], "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"firstSeconds", " ", "=", " ", 
       RowBox[{"AbsoluteTime", "[", "firstDate", "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"lastSeconds", " ", "=", " ", 
       RowBox[{"AbsoluteTime", "[", "lastDate", "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"bins", " ", "=", " ", 
       RowBox[{"Join", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"{", 
           RowBox[{"firstDate", ",", " ", "0"}], "}"}], "}"}], ",", " ", 
         "bins", ",", " ", 
         RowBox[{"{", 
          RowBox[{"{", 
           RowBox[{"lastDate", ",", " ", "0"}], "}"}], "}"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"markers", " ", "=", " ", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"minDate", ",", " ", "maxHeight"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"maxDate", ",", " ", "maxHeight"}], "}"}]}], "}"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"refreshBoundaries", "[", 
       RowBox[{"userId", ",", " ", "tagId"}], "]"}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"startMarkers", " ", "=", "  ", 
       RowBox[{"makeStartMarkers", "[", "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"stopMarkers", " ", "=", " ", 
       RowBox[{"makeStopMarkers", "[", "]"}]}], ";"}], "\n", ")"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"deleteStartBoundary", "[", "date_", "]"}], " ", ":=", " ", 
   RowBox[{"startPoints", " ", "=", " ", 
    RowBox[{"Select", "[", 
     RowBox[{"startPoints", ",", " ", 
      RowBox[{
       RowBox[{"#", " ", "\[NotEqual]", " ", "date"}], " ", "&"}]}], 
     "]"}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"deleteStopBoundary", "[", "date_", "]"}], " ", ":=", " ", 
    RowBox[{"stopPoints", " ", "=", " ", 
     RowBox[{"Select", "[", 
      RowBox[{"stopPoints", ",", " ", 
       RowBox[{
        RowBox[{"#", " ", "\[NotEqual]", " ", "date"}], " ", "&"}]}], 
      "]"}]}]}], ";"}], "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"addBoundary", "[", 
     RowBox[{"dateList_", ",", " ", "tSec_"}], "]"}], " ", ":=", " ", 
    RowBox[{"Join", "[", 
     RowBox[{"dateList", ",", " ", 
      RowBox[{"{", 
       RowBox[{"DateList", "[", "tSec", "]"}], "}"}]}], "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"addStartBoundary", "[", "]"}], " ", ":=", " ", 
   RowBox[{"startPoints", " ", "=", " ", 
    RowBox[{"addBoundary", "[", 
     RowBox[{"startPoints", ",", " ", "tStart"}], "]"}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"addStopBoundary", "[", "]"}], " ", ":=", " ", 
    RowBox[{"stopPoints", " ", "=", " ", 
     RowBox[{"addBoundary", "[", 
      RowBox[{"stopPoints", ",", " ", "tStop"}], "]"}]}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"saveStartBoundary", "[", "]"}], " ", ":=", " ", 
   RowBox[{"(", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"saveBoundary", "[", 
      RowBox[{"1", ",", " ", "1", ",", " ", "1", ",", " ", 
       RowBox[{"DateList", "[", "tStart", "]"}]}], "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"message", " ", "=", " ", 
      RowBox[{"\"\<Saved start boundary at \>\"", " ", "<>", " ", 
       RowBox[{"DateString", "[", 
        RowBox[{"tStart", ",", "sqlDateFormat"}], "]"}], " ", "<>", " ", 
       "\"\<.\>\""}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"addStartBoundary", "[", "]"}], ";"}], ")"}]}], 
  "\n"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"saveStopBoundary", "[", "]"}], " ", ":=", " ", 
   RowBox[{"(", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"message", " ", "=", " ", 
      RowBox[{"\"\<Saved stop boundary at \>\"", " ", "<>", " ", 
       RowBox[{"DateString", "[", 
        RowBox[{"tStop", ",", " ", "sqlDateFormat"}], "]"}], " ", "<>", " ", 
       "\"\<.\>\""}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"saveBoundary", "[", 
      RowBox[{"1", ",", " ", "1", ",", " ", "2", ",", " ", 
       RowBox[{"DateList", "[", "tStop", "]"}]}], "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"addStopBoundary", "[", "]"}], ";"}], ")"}]}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"sqlDateFormat", " ", "=", " ", 
   RowBox[{"{", 
    RowBox[{
    "\"\<Year\>\"", ",", " ", "\"\<-\>\"", ",", " ", "\"\<Month\>\"", ",", 
     " ", "\"\<-\>\"", ",", " ", "\"\<Day\>\"", ",", " ", "\"\< \>\"", ",", 
     " ", "\"\<Hour\>\"", ",", " ", "\"\<:\>\"", ",", " ", "\"\<Minute\>\"", 
     ",", " ", "\"\<:\>\"", ",", " ", "\"\<Second\>\""}], "}"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"sqlDate", "[", "d_", "]"}], " ", ":=", " ", 
   RowBox[{"DateString", "[", 
    RowBox[{
     RowBox[{"DateList", "[", "d", "]"}], ",", " ", "sqlDateFormat"}], " ", 
    "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"saveBoundary", "[", 
     RowBox[{
     "userId_", ",", " ", "tagId_", ",", " ", "type_", ",", " ", "date_"}], 
     "]"}], " ", ":=", " ", "\[IndentingNewLine]", 
    RowBox[{"SQLExecute", "[", 
     RowBox[{"conn", ",", " ", "\[IndentingNewLine]", 
      RowBox[{
      "\"\<insert into analytics_boundary (user_id, tag_id, type, date) \
values(\>\"", " ", "<>", " ", "\[IndentingNewLine]", 
       RowBox[{"ToString", "[", "userId", "]"}], " ", "<>", " ", "\"\<,\>\"", 
       " ", "<>", " ", "\[IndentingNewLine]", 
       RowBox[{"ToString", "[", "tagId", "]"}], " ", "<>", " ", "\"\<,\>\"", 
       "  ", "<>", "\[IndentingNewLine]", 
       RowBox[{"ToString", "[", "type", "]"}], " ", "<>", " ", "\"\<,'\>\"", 
       " ", "<>", "\[IndentingNewLine]", 
       RowBox[{"sqlDate", "[", "date", "]"}], " ", "<>", " ", 
       "\"\<');\>\""}]}], "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"deleteBoundaryInDB", "[", 
     RowBox[{
     "userId_", ",", " ", "tagId_", ",", " ", "type_", ",", " ", "date_"}], 
     "]"}], " ", ":=", " ", "\[IndentingNewLine]", 
    RowBox[{"SQLExecute", "[", 
     RowBox[{"conn", ",", " ", "\[IndentingNewLine]", 
      RowBox[{
      "\"\<delete from analytics_boundary where \>\"", "<>", 
       "\[IndentingNewLine]", "\"\<user_id=\>\"", " ", "<>", " ", 
       RowBox[{"ToString", "[", "userId", "]"}], " ", "<>", 
       "\[IndentingNewLine]", " ", "\"\< and tag_id=\>\"", " ", "<>", " ", 
       RowBox[{"ToString", "[", "tagId", "]"}], " ", "<>", " ", 
       "\[IndentingNewLine]", "\"\< and type=\>\"", "  ", "<>", " ", 
       RowBox[{"ToString", "[", "type", "]"}], " ", "<>", " ", 
       "\[IndentingNewLine]", "\"\< and date='\>\"", " ", "<>", 
       RowBox[{"sqlDate", "[", "date", "]"}], " ", "<>", " ", 
       "\"\<';\>\""}]}], "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"deleteBoundary", "[", 
    RowBox[{
    "userId_", ",", " ", "tagId_", ",", " ", "type_", ",", " ", "date_"}], 
    "]"}], " ", ":=", " ", 
   RowBox[{"(", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"type", "\[Equal]", "1"}], ",", "\[IndentingNewLine]", 
       RowBox[{"deleteStartBoundary", "[", "date", "]"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"deleteStopBoundary", "[", "date", "]"}]}], "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"deleteBoundaryInDB", "[", 
      RowBox[{
      "userId", ",", " ", "tagId", ",", " ", "type", ",", " ", "date"}], 
      "]"}], ";"}], ")"}]}], "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"userId", " ", "=", " ", 
   RowBox[{"First", "[", "userIds", "]"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"tagId", " ", "=", " ", 
    RowBox[{"First", "[", 
     RowBox[{"tagIds", "[", 
      RowBox[{"[", 
       RowBox[{"First", "[", 
        RowBox[{"First", "[", 
         RowBox[{"Position", "[", 
          RowBox[{"userIds", ",", " ", "userId"}], "]"}], "]"}], "]"}], "]"}],
       "]"}], "]"}]}], ";"}], "\n"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"message", " ", "=", " ", "\"\<\>\""}], ";"}], " "}], "\n", 
 RowBox[{
  RowBox[{"startPoints", " ", "=", " ", 
   RowBox[{"{", "}"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{"stopPoints", " ", "=", " ", 
   RowBox[{"{", "}"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{"startYear", " ", "=", " ", "2010"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"stopYear", "=", 
   RowBox[{
    RowBox[{
     RowBox[{"DateList", "[", "]"}], "[", 
     RowBox[{"[", "1", "]"}], "]"}], " ", "+", " ", "1"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{"startMonth", " ", "=", " ", "1"}], ";", " ", 
  RowBox[{"stopMonth", " ", "=", " ", "1"}], ";"}], "\n", 
 RowBox[{
  RowBox[{"startDay", " ", "=", " ", "1"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"stopDay", " ", "=", " ", "10"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"refresh", "[", "]"}], ";"}], "\[IndentingNewLine]"}], "\n", 
 RowBox[{
  RowBox[{"Multicolumn", "[", 
   RowBox[{
    RowBox[{"{", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"Style", "[", 
       RowBox[{"\"\<StartYear\>\"", ",", " ", 
        RowBox[{"Darker", "[", "Green", "]"}]}], "]"}], ",", " ", 
      RowBox[{"Slider", "[", 
       RowBox[{
        RowBox[{"Dynamic", "[", "startYear", "]"}], ",", " ", 
        RowBox[{"{", 
         RowBox[{"2010", ",", " ", "2016"}], "}"}]}], "]"}], ",", " ", 
      RowBox[{"InputField", "@", 
       RowBox[{"Dynamic", "[", "startYear", "]"}]}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{"Style", "[", 
       RowBox[{"\"\<StartMonth\>\"", ",", " ", 
        RowBox[{"Darker", "[", "Green", "]"}]}], "]"}], ",", " ", 
      RowBox[{"Slider", "[", 
       RowBox[{
        RowBox[{"Dynamic", "[", "startMonth", "]"}], ",", " ", 
        RowBox[{"{", 
         RowBox[{"1", ",", " ", "12"}], "}"}]}], "]"}], ",", " ", 
      RowBox[{"InputField", "@", 
       RowBox[{"Dynamic", "[", "startMonth", "]"}]}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{"Style", "[", 
       RowBox[{"\"\<StartDay\>\"", ",", " ", 
        RowBox[{"Darker", "[", "Green", "]"}]}], "]"}], ",", " ", 
      RowBox[{"Slider", "[", 
       RowBox[{
        RowBox[{"Dynamic", "[", "startDay", "]"}], ",", " ", 
        RowBox[{"{", 
         RowBox[{"1", ",", " ", "31"}], "}"}]}], "]"}], ",", " ", 
      RowBox[{"InputField", "@", 
       RowBox[{"Dynamic", "[", "startDay", "]"}]}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{"Style", "[", 
       RowBox[{"\"\<StopYear\>\"", ",", " ", 
        RowBox[{"Darker", "[", "Red", "]"}]}], "]"}], ",", " ", 
      RowBox[{"Slider", "[", 
       RowBox[{
        RowBox[{"Dynamic", "[", "stopYear", "]"}], ",", " ", 
        RowBox[{"{", 
         RowBox[{"2010", ",", " ", "2015"}], "}"}]}], "]"}], ",", " ", 
      RowBox[{"InputField", "@", 
       RowBox[{"Dynamic", "[", "stopYear", "]"}]}], ",", " ", 
      "\[IndentingNewLine]", 
      RowBox[{"Style", "[", 
       RowBox[{"\"\<StopMonth\>\"", ",", " ", 
        RowBox[{"Darker", "[", "Red", "]"}]}], "]"}], ",", " ", 
      RowBox[{"Slider", "[", 
       RowBox[{
        RowBox[{"Dynamic", "[", "stopMonth", "]"}], ",", " ", 
        RowBox[{"{", 
         RowBox[{"1", ",", " ", "12"}], "}"}]}], "]"}], ",", " ", 
      RowBox[{"InputField", "@", 
       RowBox[{"Dynamic", "[", "stopMonth", "]"}]}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{"Style", "[", 
       RowBox[{"\"\<StopDay\>\"", ",", " ", 
        RowBox[{"Darker", "[", "Red", "]"}]}], "]"}], ",", " ", 
      RowBox[{"Slider", "[", 
       RowBox[{
        RowBox[{"Dynamic", "[", "stopDay", "]"}], ",", " ", 
        RowBox[{"{", 
         RowBox[{"1", ",", " ", "31"}], "}"}]}], "]"}], ",", 
      RowBox[{"InputField", "@", 
       RowBox[{"Dynamic", "[", "stopDay", "]"}]}]}], "}"}], ",", "\n", "6"}], 
   "]"}], "\n"}], "\n", 
 RowBox[{
  RowBox[{"Multicolumn", "[", 
   RowBox[{
    RowBox[{"{", "\n", "  ", 
     RowBox[{
      RowBox[{"Style", "[", 
       RowBox[{"\"\<User ID\>\"", ",", " ", 
        RowBox[{"Darker", "[", "Blue", "]"}]}], "]"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{"PopupMenu", "[", 
       RowBox[{
        RowBox[{"Dynamic", "[", "userId", "]"}], ",", " ", "userIds"}], "]"}],
       ",", "\[IndentingNewLine]", 
      RowBox[{"Style", "[", 
       RowBox[{"\"\<Tag ID\>\"", ",", " ", 
        RowBox[{"Darker", "[", "Purple", "]"}]}], "]"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{"Dynamic", "[", 
       RowBox[{"PopupMenu", "[", 
        RowBox[{
         RowBox[{"Dynamic", "[", "tagId", "]"}], ",", " ", 
         RowBox[{"tagIdsForUser", "[", "userId", "]"}]}], "]"}], "]"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{"Style", "[", 
       RowBox[{"\"\<\>\"", ",", " ", "Black"}], "]"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{"Button", "[", 
       RowBox[{"\"\<Refresh\>\"", ",", " ", 
        RowBox[{
         RowBox[{"refresh", "[", "]"}], " ", "&"}]}], " ", "]"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{"Style", "[", 
       RowBox[{"\"\<\>\"", ",", " ", "Black"}], "]"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{"Button", "[", 
       RowBox[{"\"\<Previous Tag\>\"", ",", " ", 
        RowBox[{
         RowBox[{"(", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"tagId", " ", "=", " ", 
            RowBox[{"previousTag", "[", "]"}]}], ";", "\[IndentingNewLine]", 
           RowBox[{"refresh", "[", "]"}], ";"}], ")"}], " ", "&"}]}], " ", 
       "]"}], ",", "\[IndentingNewLine]", 
      RowBox[{"Style", "[", 
       RowBox[{"\"\<\>\"", ",", " ", "Black"}], "]"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{"Button", "[", 
       RowBox[{"\"\<Next Tag\>\"", ",", " ", 
        RowBox[{
         RowBox[{"(", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"tagId", " ", "=", " ", 
            RowBox[{"nextTag", "[", "]"}]}], ";", "\[IndentingNewLine]", 
           RowBox[{"refresh", "[", "]"}], ";"}], ")"}], " ", "&"}]}], " ", 
       "]"}]}], "\n", "}"}], ",", " ", "6"}], "]"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Dynamic", "[", "message", "]"}], "\n"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"{", 
   RowBox[{
    RowBox[{"Slider", "[", 
     RowBox[{
      RowBox[{"Dynamic", "[", "tStart", "]"}], ",", " ", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"Dynamic", "[", "firstSeconds", "]"}], ",", " ", 
        RowBox[{"Dynamic", "[", "lastSeconds", "]"}]}], "}"}], ",", " ", 
      RowBox[{"ImageSize", " ", "\[Rule]", " ", "500"}]}], "]"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{"Button", "[", 
     RowBox[{"\"\<-9 days\>\"", ",", " ", 
      RowBox[{"tStart", " ", "-=", " ", 
       RowBox[{"9", "*", "24", "*", "60", "*", "60"}]}]}], "]"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{"Button", "[", 
     RowBox[{"\"\<-3 days\>\"", ",", " ", 
      RowBox[{"tStart", " ", "-=", " ", 
       RowBox[{"3", "*", "24", "*", "60", "*", "60"}]}]}], "]"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{"Button", "[", 
     RowBox[{"\"\<-1 day\>\"", ",", " ", 
      RowBox[{"tStart", " ", "-=", " ", 
       RowBox[{"24", "*", "60", "*", "60"}]}]}], "]"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{"Button", "[", 
     RowBox[{"\"\<+1 day\>\"", ",", " ", 
      RowBox[{"tStart", " ", "+=", " ", 
       RowBox[{"24", "*", "60", "*", "60"}]}]}], "]"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{"Button", "[", 
     RowBox[{"\"\<+3 days\>\"", ",", " ", 
      RowBox[{"tStart", " ", "+=", " ", 
       RowBox[{"3", "*", "24", "*", "60", "*", "60"}]}]}], "]"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{"Button", "[", 
     RowBox[{"\"\<+9 days\>\"", ",", " ", 
      RowBox[{"tStart", " ", "+=", " ", 
       RowBox[{"9", "*", "24", "*", "60", "*", "60"}]}]}], "]"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{"Dynamic", "[", 
     RowBox[{"DateString", "[", 
      RowBox[{"tStart", ",", " ", "sqlDateFormat"}], "]"}], "]"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{"Button", "[", 
     RowBox[{"\"\<Save Start Time\>\"", ",", " ", 
      RowBox[{"saveStartBoundary", "[", "]"}]}], " ", "]"}]}], "}"}], 
  "\n"}], "\n", 
 RowBox[{
  RowBox[{"{", 
   RowBox[{
    RowBox[{"Slider", "[", 
     RowBox[{
      RowBox[{"Dynamic", "[", "tStop", "]"}], ",", " ", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"Dynamic", "[", "firstSeconds", "]"}], ",", " ", 
        RowBox[{"Dynamic", "[", "lastSeconds", "]"}]}], "}"}], ",", " ", 
      RowBox[{"ImageSize", " ", "\[Rule]", " ", "500"}]}], "]"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{"Button", "[", 
     RowBox[{"\"\<-9 days\>\"", ",", " ", 
      RowBox[{"tStart", " ", "-=", " ", 
       RowBox[{"9", "*", "24", "*", "60", "*", "60"}]}]}], "]"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{"Button", "[", 
     RowBox[{"\"\<-3 days\>\"", ",", " ", 
      RowBox[{"tStart", " ", "-=", " ", 
       RowBox[{"3", "*", "24", "*", "60", "*", "60"}]}]}], "]"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{"Button", "[", 
     RowBox[{"\"\<-1 day\>\"", ",", " ", 
      RowBox[{"tStart", " ", "-=", " ", 
       RowBox[{"24", "*", "60", "*", "60"}]}]}], "]"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{"Button", "[", 
     RowBox[{"\"\<+1 day\>\"", ",", " ", 
      RowBox[{"tStart", " ", "+=", " ", 
       RowBox[{"24", "*", "60", "*", "60"}]}]}], "]"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{"Button", "[", 
     RowBox[{"\"\<+3 days\>\"", ",", " ", 
      RowBox[{"tStart", " ", "+=", " ", 
       RowBox[{"3", "*", "24", "*", "60", "*", "60"}]}]}], "]"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{"Button", "[", 
     RowBox[{"\"\<+9 days\>\"", ",", " ", 
      RowBox[{"tStart", " ", "+=", " ", 
       RowBox[{"9", "*", "24", "*", "60", "*", "60"}]}]}], "]"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{"Dynamic", "[", 
     RowBox[{"DateString", "[", 
      RowBox[{"tStart", ",", " ", "sqlDateFormat"}], "]"}], "]"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{"Button", "[", 
     RowBox[{"\"\<Save Stop Time\>\"", ",", " ", 
      RowBox[{"saveStopBoundary", "[", "]"}]}], "]"}]}], "}"}], "\n", 
  RowBox[{"(*", 
   RowBox[{"{", 
    RowBox[{"bins", ",", " ", "\[IndentingNewLine]", 
     RowBox[{"Join", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{
           RowBox[{"DateList", "[", "tStart", "]"}], "[", 
           RowBox[{"[", 
            RowBox[{";;", "3"}], "]"}], "]"}], ",", "maxHeight"}], "}"}], 
        "}"}], ",", " ", 
       RowBox[{"startMarkers", "[", "]"}]}], "]"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"Join", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{
           RowBox[{"DateList", "[", "tStop", "]"}], "[", 
           RowBox[{"[", 
            RowBox[{"1", ";;", "3"}], "]"}], "]"}], ",", " ", "maxHeight"}], 
         "}"}], "}"}], ",", " ", 
       RowBox[{"stopMarkers", "[", "]"}]}], "]"}]}], "}"}], "*)"}], 
  "\n"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Dynamic", "[", 
   RowBox[{"DateListPlot", "[", " ", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"bins", ",", " ", "\[IndentingNewLine]", 
       RowBox[{"makeStartMarkers", "[", "]"}], ",", "\[IndentingNewLine]", 
       RowBox[{"makeStopMarkers", "[", "]"}]}], "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"AspectRatio", "\[Rule]", 
      RowBox[{"1", "/", "5"}]}], ",", " ", "\[IndentingNewLine]", 
     RowBox[{"PlotMarkers", " ", "\[Rule]", " ", "\"\<*\>\""}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"PlotStyle", " ", "\[Rule]", " ", 
      RowBox[{"{", 
       RowBox[{"Blue", ",", " ", "Green", ",", " ", "Red"}], "}"}]}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"ImageSize", "\[Rule]", " ", "1000"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"Filling", " ", "\[Rule]", " ", "Bottom"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"Joined", " ", "\[Rule]", " ", "False"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"PlotRange", " ", "->", " ", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{"DateList", "[", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"Floor", "[", "startYear", "]"}], ",", 
             RowBox[{"Floor", "[", "startMonth", "]"}], ",", 
             RowBox[{"Floor", "[", "startDay", "]"}]}], "}"}], "]"}], ",", 
          " ", 
          RowBox[{"DateList", "[", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"Floor", "[", "stopYear", "]"}], ",", " ", 
             RowBox[{"Floor", "[", "stopMonth", "]"}], ",", " ", 
             RowBox[{"Floor", "[", "stopDay", "]"}]}], "}"}], "]"}]}], "}"}], 
        ",", " ", "Automatic"}], "}"}]}]}], "]"}], "]"}], " ", 
  "\n"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Framed", "[", "\[IndentingNewLine]", 
   RowBox[{"Multicolumn", "[", 
    RowBox[{
     RowBox[{"{", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"Style", "[", 
        RowBox[{"\"\<Start points\>\"", ",", " ", "Bold"}], "]"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"Dynamic", "@", 
        RowBox[{"Dataset", "@", 
         RowBox[{"Map", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"{", 
             RowBox[{
              RowBox[{"DateString", "[", 
               RowBox[{
                RowBox[{"DateList", "[", "#", "]"}], ",", " ", 
                "sqlDateFormat"}], "]"}], ",", " ", 
              RowBox[{"Button", "[", 
               RowBox[{"\"\<Delete\>\"", ",", 
                RowBox[{"deleteBoundary", "[", 
                 RowBox[{
                 "userId", ",", " ", "tagId", ",", " ", "1", ",", " ", "#"}], 
                 "]"}]}], "]"}]}], " ", "}"}], "&"}], ",", 
           RowBox[{"Sort", "[", "startPoints", "]"}]}], "]"}]}]}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"Style", "[", 
        RowBox[{"\"\<Stop points\>\"", ",", " ", "Bold"}], "]"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"Dynamic", "@", 
        RowBox[{"Dataset", "@", 
         RowBox[{"Map", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"{", 
             RowBox[{
              RowBox[{"DateString", "[", 
               RowBox[{
                RowBox[{"DateList", "[", "#", "]"}], ",", " ", 
                "sqlDateFormat"}], "]"}], ",", " ", 
              RowBox[{"Button", "[", 
               RowBox[{"\"\<Delete\>\"", ",", 
                RowBox[{"deleteBoundary", "[", 
                 RowBox[{
                 "userId", ",", " ", "tagId", ",", " ", "2", ",", "#"}], 
                 "]"}]}], "]"}]}], " ", "}"}], "&"}], ",", 
           RowBox[{"Sort", "[", "stopPoints", "]"}]}], "]"}]}]}]}], " ", 
      "}"}], ",", "2"}], "]"}], "]"}], "\[IndentingNewLine]", 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]"}], "Input",
 CellChangeTimes->{{3.638576553515642*^9, 3.638576559471533*^9}, 
   3.638576633540379*^9, {3.638576989812957*^9, 3.638576991405508*^9}, {
   3.638577540183518*^9, 3.6385775673641567`*^9}, {3.6385776629403067`*^9, 
   3.638577674986053*^9}, {3.6385785541514387`*^9, 3.638578566724288*^9}, {
   3.638578853800261*^9, 3.638578856129747*^9}, 3.638578949518812*^9, {
   3.6385793375110064`*^9, 3.638579357624495*^9}, {3.638579645978037*^9, 
   3.638579649606472*^9}, {3.6385797078760767`*^9, 3.638579713276636*^9}, {
   3.638579807454089*^9, 3.6385798719256163`*^9}, {3.638579925783937*^9, 
   3.63858008201884*^9}, {3.6385801504762497`*^9, 3.638580175876062*^9}, {
   3.638580215487855*^9, 3.638580405199348*^9}, {3.638580614131707*^9, 
   3.638580639489541*^9}, {3.638580713921616*^9, 3.638580774114312*^9}, {
   3.638580873311105*^9, 3.6385808820476017`*^9}, {3.638580951364141*^9, 
   3.638580953888515*^9}, {3.6385894292142344`*^9, 3.6385895367626667`*^9}, {
   3.638589584821302*^9, 3.6385895984816*^9}, {3.6385897069831*^9, 
   3.6385897976931143`*^9}, {3.638591677464602*^9, 3.63859168669068*^9}, 
   3.6385919236486893`*^9, {3.638592077513998*^9, 3.638592310138859*^9}, {
   3.6385923567224817`*^9, 3.638592452376301*^9}, {3.638592515640341*^9, 
   3.638592534907258*^9}, {3.6385928544145107`*^9, 3.638592866725226*^9}, {
   3.638592952261034*^9, 3.638592983752898*^9}, 3.638593034713394*^9, {
   3.638593206894994*^9, 3.638593208479755*^9}, {3.638593248230941*^9, 
   3.638593289720867*^9}, {3.6385933216846037`*^9, 3.63859332287467*^9}, {
   3.6385936343995543`*^9, 3.6385936422293043`*^9}, {3.6385936932263308`*^9, 
   3.6385936944005947`*^9}, {3.638593830390449*^9, 3.638593907584319*^9}, {
   3.638593986905404*^9, 3.638594011975765*^9}, {3.638594057371655*^9, 
   3.6385940595060596`*^9}, {3.638594106206108*^9, 3.638594147987986*^9}, {
   3.638594241906066*^9, 3.6385942530234118`*^9}, {3.638594290931294*^9, 
   3.638594293189726*^9}, {3.638594334886683*^9, 3.638594347679332*^9}, {
   3.638594386522255*^9, 3.6385944851312838`*^9}, 3.638594533467936*^9, {
   3.6386591565034647`*^9, 3.6386591741660023`*^9}, {3.6386602606481333`*^9, 
   3.638660267665386*^9}, {3.63866030245577*^9, 3.638660323085578*^9}, {
   3.638660445149303*^9, 3.6386604484384413`*^9}, {3.638660502951742*^9, 
   3.638660553579556*^9}, {3.638660651105795*^9, 3.638660653429763*^9}, {
   3.638660684787415*^9, 3.6386606902177267`*^9}, {3.6386607692519083`*^9, 
   3.638660891183318*^9}, {3.638661005679134*^9, 3.6386610079245367`*^9}, {
   3.638661134557342*^9, 3.638661146688377*^9}, {3.638661181742141*^9, 
   3.63866118355577*^9}, {3.638661237797174*^9, 3.6386612535745153`*^9}, {
   3.638661479217869*^9, 3.6386614840200167`*^9}, 3.6386616155925627`*^9, {
   3.638662034705051*^9, 3.6386620686171923`*^9}, 3.638662109875535*^9, {
   3.638662254316764*^9, 3.638662288746668*^9}, {3.638662376284103*^9, 
   3.638662378837573*^9}, {3.638662451232272*^9, 3.638662465356287*^9}, {
   3.6386625158881474`*^9, 3.638662569258699*^9}, {3.638662644330907*^9, 
   3.638662767257709*^9}, {3.638663115271267*^9, 3.638663182872417*^9}, {
   3.638663287363545*^9, 3.638663287899832*^9}, {3.6386633247861834`*^9, 
   3.6386633637056227`*^9}, {3.6386633973851833`*^9, 3.638663417151979*^9}, {
   3.638663457157014*^9, 3.6386634622880697`*^9}, {3.638666977813484*^9, 
   3.638667003992358*^9}, {3.638667061312901*^9, 3.638667061853204*^9}, {
   3.6386672108910103`*^9, 3.638667253841284*^9}, {3.6386673264447613`*^9, 
   3.638667332775322*^9}, {3.638668283863065*^9, 3.638668294372788*^9}, {
   3.638668778715877*^9, 3.638668785915575*^9}, {3.6386688940970707`*^9, 
   3.638668898006461*^9}, {3.638668936922966*^9, 3.6386690667262573`*^9}, {
   3.6386693500492773`*^9, 3.638669369604759*^9}, {3.638669409842503*^9, 
   3.638669455970326*^9}, {3.638669492127281*^9, 3.6386695193520737`*^9}, {
   3.638669824735013*^9, 3.638669847509879*^9}, {3.638669972137671*^9, 
   3.6386700421833057`*^9}, {3.638670104761673*^9, 3.63867013004836*^9}, {
   3.6386702157151413`*^9, 3.638670279931176*^9}, {3.638670332896782*^9, 
   3.638670344713879*^9}, {3.638670390771257*^9, 3.6386704020802383`*^9}, {
   3.638670487056727*^9, 3.638670529683531*^9}, {3.6386705687691174`*^9, 
   3.638670652287795*^9}, {3.6386706886115637`*^9, 3.638670776324058*^9}, {
   3.638671112320424*^9, 3.638671123164569*^9}, {3.6386711609803267`*^9, 
   3.6386711785443077`*^9}, {3.638671240825816*^9, 3.638671403423379*^9}, {
   3.638671503255246*^9, 3.638671526487657*^9}, {3.638671594913207*^9, 
   3.6386716272656097`*^9}, {3.63867168081946*^9, 3.6386717066845417`*^9}, {
   3.6386718189040833`*^9, 3.638671904148891*^9}, {3.638671964906732*^9, 
   3.638671965306383*^9}}],

Cell[BoxData[
 TagBox[GridBox[{
    {
     StyleBox["\<\"StartYear\"\>",
      StripOnInput->False,
      LineColor->RGBColor[0, 
        Rational[2, 3], 0],
      FrontFaceColor->RGBColor[0, 
        Rational[2, 3], 0],
      BackFaceColor->RGBColor[0, 
        Rational[2, 3], 0],
      GraphicsColor->RGBColor[0, 
        Rational[2, 3], 0],
      FontColor->RGBColor[0, 
        Rational[2, 3], 0]], 
     StyleBox["\<\"StartMonth\"\>",
      StripOnInput->False,
      LineColor->RGBColor[0, 
        Rational[2, 3], 0],
      FrontFaceColor->RGBColor[0, 
        Rational[2, 3], 0],
      BackFaceColor->RGBColor[0, 
        Rational[2, 3], 0],
      GraphicsColor->RGBColor[0, 
        Rational[2, 3], 0],
      FontColor->RGBColor[0, 
        Rational[2, 3], 0]], 
     StyleBox["\<\"StartDay\"\>",
      StripOnInput->False,
      LineColor->RGBColor[0, 
        Rational[2, 3], 0],
      FrontFaceColor->RGBColor[0, 
        Rational[2, 3], 0],
      BackFaceColor->RGBColor[0, 
        Rational[2, 3], 0],
      GraphicsColor->RGBColor[0, 
        Rational[2, 3], 0],
      FontColor->RGBColor[0, 
        Rational[2, 3], 0]], 
     StyleBox["\<\"StopYear\"\>",
      StripOnInput->False,
      LineColor->RGBColor[
        Rational[2, 3], 0, 0],
      FrontFaceColor->RGBColor[
        Rational[2, 3], 0, 0],
      BackFaceColor->RGBColor[
        Rational[2, 3], 0, 0],
      GraphicsColor->RGBColor[
        Rational[2, 3], 0, 0],
      FontColor->RGBColor[
        Rational[2, 3], 0, 0]], 
     StyleBox["\<\"StopMonth\"\>",
      StripOnInput->False,
      LineColor->RGBColor[
        Rational[2, 3], 0, 0],
      FrontFaceColor->RGBColor[
        Rational[2, 3], 0, 0],
      BackFaceColor->RGBColor[
        Rational[2, 3], 0, 0],
      GraphicsColor->RGBColor[
        Rational[2, 3], 0, 0],
      FontColor->RGBColor[
        Rational[2, 3], 0, 0]], 
     StyleBox["\<\"StopDay\"\>",
      StripOnInput->False,
      LineColor->RGBColor[
        Rational[2, 3], 0, 0],
      FrontFaceColor->RGBColor[
        Rational[2, 3], 0, 0],
      BackFaceColor->RGBColor[
        Rational[2, 3], 0, 0],
      GraphicsColor->RGBColor[
        Rational[2, 3], 0, 0],
      FontColor->RGBColor[
        Rational[2, 3], 0, 0]]},
    {
     SliderBox[Dynamic[$CellContext`startYear], {2010, 2016}], 
     SliderBox[Dynamic[$CellContext`startMonth], {1, 12}], 
     SliderBox[Dynamic[$CellContext`startDay], {1, 31}], 
     SliderBox[Dynamic[$CellContext`stopYear], {2010, 2015}], 
     SliderBox[Dynamic[$CellContext`stopMonth], {1, 12}], 
     SliderBox[Dynamic[$CellContext`stopDay], {1, 31}]},
    {
     InputFieldBox[Dynamic[$CellContext`startYear]], 
     InputFieldBox[Dynamic[$CellContext`startMonth]], 
     InputFieldBox[Dynamic[$CellContext`startDay]], 
     InputFieldBox[Dynamic[$CellContext`stopYear]], 
     InputFieldBox[Dynamic[$CellContext`stopMonth]], 
     InputFieldBox[Dynamic[$CellContext`stopDay]]}
   },
   AutoDelete->False,
   GridBoxAlignment->{"Columns" -> {{Left}}, "Rows" -> {{Baseline}}},
   GridBoxItemSize->{"Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}],
  "Grid"]], "Output",
 CellChangeTimes->{
  3.638661256230165*^9, 3.638662100473147*^9, 3.638662310094727*^9, 
   3.638662384347365*^9, 3.638662774347929*^9, 3.638663187977682*^9, 
   3.638663370685783*^9, 3.638663471126631*^9, 3.638666904020385*^9, {
   3.638667006472212*^9, 3.6386670306190243`*^9}, 3.6386672657027693`*^9, 
   3.638668211977564*^9, 3.6386682451258173`*^9, {3.6386682971333847`*^9, 
   3.6386683209703083`*^9}, 3.6386687880900517`*^9, 3.638668903086602*^9, 
   3.6386689640281*^9, 3.6386690729151287`*^9, 3.638669371815316*^9, {
   3.6386694757863626`*^9, 3.63866952429547*^9}, {3.638669830740303*^9, 
   3.6386698491900587`*^9}, 3.638670047318047*^9, 3.638670134785776*^9, 
   3.6386702880058413`*^9, 3.638670408407794*^9, {3.638670508128063*^9, 
   3.638670532361928*^9}, 3.638670963113089*^9, 3.638671133742345*^9, {
   3.638671183480856*^9, 3.638671204759144*^9}, 3.638671411696754*^9, {
   3.638671547260375*^9, 3.638671570753237*^9}, 3.638671660194805*^9, 
   3.638671718904862*^9, 3.638671859648642*^9, 3.63867190747836*^9, 
   3.638671968352046*^9, 3.638672018436501*^9}],

Cell[BoxData[
 TagBox[GridBox[{
    {
     StyleBox["\<\"User ID\"\>",
      StripOnInput->False,
      LineColor->RGBColor[0, 0, 
        Rational[2, 3]],
      FrontFaceColor->RGBColor[0, 0, 
        Rational[2, 3]],
      BackFaceColor->RGBColor[0, 0, 
        Rational[2, 3]],
      GraphicsColor->RGBColor[0, 0, 
        Rational[2, 3]],
      FontColor->RGBColor[0, 0, 
        Rational[2, 3]]], 
     StyleBox["\<\"Tag ID\"\>",
      StripOnInput->False,
      LineColor->RGBColor[0.33333333333333337`, 0, 0.33333333333333337`],
      FrontFaceColor->RGBColor[0.33333333333333337`, 0, 0.33333333333333337`],
      
      BackFaceColor->RGBColor[0.33333333333333337`, 0, 0.33333333333333337`],
      GraphicsColor->RGBColor[0.33333333333333337`, 0, 0.33333333333333337`],
      FontColor->RGBColor[0.33333333333333337`, 0, 0.33333333333333337`]], 
     StyleBox["\<\"\"\>",
      StripOnInput->False,
      LineColor->GrayLevel[0],
      FrontFaceColor->GrayLevel[0],
      BackFaceColor->GrayLevel[0],
      GraphicsColor->GrayLevel[0],
      FontColor->GrayLevel[0]], 
     StyleBox["\<\"\"\>",
      StripOnInput->False,
      LineColor->GrayLevel[0],
      FrontFaceColor->GrayLevel[0],
      BackFaceColor->GrayLevel[0],
      GraphicsColor->GrayLevel[0],
      FontColor->GrayLevel[0]], 
     StyleBox["\<\"\"\>",
      StripOnInput->False,
      LineColor->GrayLevel[0],
      FrontFaceColor->GrayLevel[0],
      BackFaceColor->GrayLevel[0],
      GraphicsColor->GrayLevel[0],
      FontColor->GrayLevel[0]], "\<\"\"\>"},
    {
     PopupMenuBox[Dynamic[$CellContext`userId], {1->"1", 4->"4", 5->"5", 7->
      "7", 8->"8", 9->"9", 14->"14", 15->"15", 16->"16", 17->"17", 18->"18", 
      19->"19", 20->"20", 21->"21", 22->"22", 23->"23", 24->"24", 25->"25", 
      26->"26", 27->"27", 28->"28", 29->"29", 30->"30", 31->"31", 32->"32", 
      33->"33", 34->"34", 35->"35", 36->"36", 37->"37", 38->"38", 39->"39", 
      40->"40", 41->"41", 42->"42", 43->"43", 44->"44", 45->"45", 46->"46", 
      47->"47", 48->"48", 49->"49", 50->"50", 51->"51", 52->"52", 53->"53", 
      54->"54", 55->"55", 56->"56", 57->"57", 58->"58", 59->"59", 60->"60", 
      61->"61", 62->"62", 63->"63", 64->"64", 65->"65", 66->"66", 68->"68", 
      69->"69", 70->"70", 71->"71", 72->"72", 73->"73", 74->"74", 75->"75", 
      76->"76", 77->"77", 78->"78", 79->"79", 80->"80", 81->"81", 82->"82", 
      83->"83", 84->"84", 85->"85", 86->"86", 87->"87", 88->"88", 89->"89", 
      90->"90", 91->"91", 92->"92", 93->"93", 94->"94", 95->"95", 96->"96", 
      97->"97", 98->"98", 99->"99", 100->"100", 101->"101", 102->"102", 103->
      "103", 104->"104", 105->"105", 106->"106", 107->"107", 108->"108", 109->
      "109", 110->"110", 111->"111", 112->"112", 113->"113", 114->"114", 115->
      "115", 116->"116", 117->"117", 118->"118", 119->"119", 120->"120", 121->
      "121", 122->"122", 123->"123", 124->"124", 125->"125", 126->"126", 127->
      "127", 128->"128", 129->"129", 130->"130", 131->"131", 132->"132", 133->
      "133", 134->"134", 135->"135", 136->"136", 137->"137", 138->"138", 139->
      "139", 140->"140", 141->"141", 142->"142", 143->"143", 144->"144", 145->
      "145", 146->"146", 147->"147", 148->"148", 149->"149", 150->"150", 151->
      "151", 152->"152", 153->"153", 154->"154", 155->"155", 156->"156", 157->
      "157", 158->"158", 159->"159", 160->"160", 161->"161", 162->"162", 163->
      "163", 164->"164", 165->"165", 166->"166", 167->"167", 168->"168", 169->
      "169", 170->"170", 171->"171", 172->"172", 173->"173", 174->"174", 175->
      "175", 176->"176", 177->"177", 178->"178"}], 
     DynamicBox[ToBoxes[
       PopupMenu[
        Dynamic[$CellContext`tagId], 
        $CellContext`tagIdsForUser[$CellContext`userId]], StandardForm],
      ImageSizeCache->{66., {8., 17.}}], 
     ButtonBox["\<\"Refresh\"\>",
      Appearance->Automatic,
      ButtonFunction:>($CellContext`refresh[]& ),
      Evaluator->Automatic,
      Method->"Preemptive"], 
     ButtonBox["\<\"Previous Tag\"\>",
      Appearance->Automatic,
      ButtonFunction:>(($CellContext`tagId = $CellContext`previousTag[]; \
$CellContext`refresh[]; Null)& ),
      Evaluator->Automatic,
      Method->"Preemptive"], 
     ButtonBox["\<\"Next Tag\"\>",
      Appearance->Automatic,
      ButtonFunction:>(($CellContext`tagId = $CellContext`nextTag[]; \
$CellContext`refresh[]; Null)& ),
      Evaluator->Automatic,
      Method->"Preemptive"], "\<\"\"\>"}
   },
   AutoDelete->False,
   GridBoxAlignment->{"Columns" -> {{Left}}, "Rows" -> {{Baseline}}},
   GridBoxItemSize->{"Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}],
  "Grid"]], "Output",
 CellChangeTimes->{
  3.638661256230165*^9, 3.638662100473147*^9, 3.638662310094727*^9, 
   3.638662384347365*^9, 3.638662774347929*^9, 3.638663187977682*^9, 
   3.638663370685783*^9, 3.638663471126631*^9, 3.638666904020385*^9, {
   3.638667006472212*^9, 3.6386670306190243`*^9}, 3.6386672657027693`*^9, 
   3.638668211977564*^9, 3.6386682451258173`*^9, {3.6386682971333847`*^9, 
   3.6386683209703083`*^9}, 3.6386687880900517`*^9, 3.638668903086602*^9, 
   3.6386689640281*^9, 3.6386690729151287`*^9, 3.638669371815316*^9, {
   3.6386694757863626`*^9, 3.63866952429547*^9}, {3.638669830740303*^9, 
   3.6386698491900587`*^9}, 3.638670047318047*^9, 3.638670134785776*^9, 
   3.6386702880058413`*^9, 3.638670408407794*^9, {3.638670508128063*^9, 
   3.638670532361928*^9}, 3.638670963113089*^9, 3.638671133742345*^9, {
   3.638671183480856*^9, 3.638671204759144*^9}, 3.638671411696754*^9, {
   3.638671547260375*^9, 3.638671570753237*^9}, 3.638671660194805*^9, 
   3.638671718904862*^9, 3.638671859648642*^9, 3.63867190747836*^9, 
   3.638671968352046*^9, 3.63867201844273*^9}],

Cell[BoxData[
 DynamicBox[ToBoxes[$CellContext`message, StandardForm],
  ImageSizeCache->{366., {3., 10.}}]], "Output",
 CellChangeTimes->{
  3.638661256230165*^9, 3.638662100473147*^9, 3.638662310094727*^9, 
   3.638662384347365*^9, 3.638662774347929*^9, 3.638663187977682*^9, 
   3.638663370685783*^9, 3.638663471126631*^9, 3.638666904020385*^9, {
   3.638667006472212*^9, 3.6386670306190243`*^9}, 3.6386672657027693`*^9, 
   3.638668211977564*^9, 3.6386682451258173`*^9, {3.6386682971333847`*^9, 
   3.6386683209703083`*^9}, 3.6386687880900517`*^9, 3.638668903086602*^9, 
   3.6386689640281*^9, 3.6386690729151287`*^9, 3.638669371815316*^9, {
   3.6386694757863626`*^9, 3.63866952429547*^9}, {3.638669830740303*^9, 
   3.6386698491900587`*^9}, 3.638670047318047*^9, 3.638670134785776*^9, 
   3.6386702880058413`*^9, 3.638670408407794*^9, {3.638670508128063*^9, 
   3.638670532361928*^9}, 3.638670963113089*^9, 3.638671133742345*^9, {
   3.638671183480856*^9, 3.638671204759144*^9}, 3.638671411696754*^9, {
   3.638671547260375*^9, 3.638671570753237*^9}, 3.638671660194805*^9, 
   3.638671718904862*^9, 3.638671859648642*^9, 3.63867190747836*^9, 
   3.638671968352046*^9, 3.638672018447425*^9}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   SliderBox[Dynamic[
     BoxForm`RemapVariable[$CellContext`tStart, {$CellContext`firstSeconds, \
$CellContext`lastSeconds}], 
     BoxForm`RemapValue[#, $CellContext`tStart, {$CellContext`firstSeconds, \
$CellContext`lastSeconds}]& ], {0, 1},
    ImageSize->500], ",", 
   ButtonBox["\<\"-9 days\"\>",
    Appearance->Automatic,
    ButtonFunction:>SubtractFrom[$CellContext`tStart, 9 24 60 60],
    Evaluator->Automatic,
    Method->"Preemptive"], ",", 
   ButtonBox["\<\"-3 days\"\>",
    Appearance->Automatic,
    ButtonFunction:>SubtractFrom[$CellContext`tStart, 3 24 60 60],
    Evaluator->Automatic,
    Method->"Preemptive"], ",", 
   ButtonBox["\<\"-1 day\"\>",
    Appearance->Automatic,
    ButtonFunction:>SubtractFrom[$CellContext`tStart, 24 60 60],
    Evaluator->Automatic,
    Method->"Preemptive"], ",", 
   ButtonBox["\<\"+1 day\"\>",
    Appearance->Automatic,
    ButtonFunction:>AddTo[$CellContext`tStart, 24 60 60],
    Evaluator->Automatic,
    Method->"Preemptive"], ",", 
   ButtonBox["\<\"+3 days\"\>",
    Appearance->Automatic,
    ButtonFunction:>AddTo[$CellContext`tStart, 3 24 60 60],
    Evaluator->Automatic,
    Method->"Preemptive"], ",", 
   ButtonBox["\<\"+9 days\"\>",
    Appearance->Automatic,
    ButtonFunction:>AddTo[$CellContext`tStart, 9 24 60 60],
    Evaluator->Automatic,
    Method->"Preemptive"], ",", 
   DynamicBox[ToBoxes[
     DateString[$CellContext`tStart, $CellContext`sqlDateFormat], 
     StandardForm],
    ImageSizeCache->{170., {0., 10.}}], ",", 
   ButtonBox["\<\"Save Start Time\"\>",
    Appearance->Automatic,
    ButtonFunction:>$CellContext`saveStartBoundary[],
    Evaluator->Automatic,
    Method->"Preemptive"]}], "}"}]], "Output",
 CellChangeTimes->{
  3.638661256230165*^9, 3.638662100473147*^9, 3.638662310094727*^9, 
   3.638662384347365*^9, 3.638662774347929*^9, 3.638663187977682*^9, 
   3.638663370685783*^9, 3.638663471126631*^9, 3.638666904020385*^9, {
   3.638667006472212*^9, 3.6386670306190243`*^9}, 3.6386672657027693`*^9, 
   3.638668211977564*^9, 3.6386682451258173`*^9, {3.6386682971333847`*^9, 
   3.6386683209703083`*^9}, 3.6386687880900517`*^9, 3.638668903086602*^9, 
   3.6386689640281*^9, 3.6386690729151287`*^9, 3.638669371815316*^9, {
   3.6386694757863626`*^9, 3.63866952429547*^9}, {3.638669830740303*^9, 
   3.6386698491900587`*^9}, 3.638670047318047*^9, 3.638670134785776*^9, 
   3.6386702880058413`*^9, 3.638670408407794*^9, {3.638670508128063*^9, 
   3.638670532361928*^9}, 3.638670963113089*^9, 3.638671133742345*^9, {
   3.638671183480856*^9, 3.638671204759144*^9}, 3.638671411696754*^9, {
   3.638671547260375*^9, 3.638671570753237*^9}, 3.638671660194805*^9, 
   3.638671718904862*^9, 3.638671859648642*^9, 3.63867190747836*^9, 
   3.638671968352046*^9, 3.638672018449741*^9}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   SliderBox[Dynamic[
     BoxForm`RemapVariable[$CellContext`tStop, {$CellContext`firstSeconds, \
$CellContext`lastSeconds}], 
     BoxForm`RemapValue[#, $CellContext`tStop, {$CellContext`firstSeconds, \
$CellContext`lastSeconds}]& ], {0, 1},
    ImageSize->500], ",", 
   ButtonBox["\<\"-9 days\"\>",
    Appearance->Automatic,
    ButtonFunction:>SubtractFrom[$CellContext`tStart, 9 24 60 60],
    Evaluator->Automatic,
    Method->"Preemptive"], ",", 
   ButtonBox["\<\"-3 days\"\>",
    Appearance->Automatic,
    ButtonFunction:>SubtractFrom[$CellContext`tStart, 3 24 60 60],
    Evaluator->Automatic,
    Method->"Preemptive"], ",", 
   ButtonBox["\<\"-1 day\"\>",
    Appearance->Automatic,
    ButtonFunction:>SubtractFrom[$CellContext`tStart, 24 60 60],
    Evaluator->Automatic,
    Method->"Preemptive"], ",", 
   ButtonBox["\<\"+1 day\"\>",
    Appearance->Automatic,
    ButtonFunction:>AddTo[$CellContext`tStart, 24 60 60],
    Evaluator->Automatic,
    Method->"Preemptive"], ",", 
   ButtonBox["\<\"+3 days\"\>",
    Appearance->Automatic,
    ButtonFunction:>AddTo[$CellContext`tStart, 3 24 60 60],
    Evaluator->Automatic,
    Method->"Preemptive"], ",", 
   ButtonBox["\<\"+9 days\"\>",
    Appearance->Automatic,
    ButtonFunction:>AddTo[$CellContext`tStart, 9 24 60 60],
    Evaluator->Automatic,
    Method->"Preemptive"], ",", 
   DynamicBox[ToBoxes[
     DateString[$CellContext`tStart, $CellContext`sqlDateFormat], 
     StandardForm],
    ImageSizeCache->{170., {0., 10.}}], ",", 
   ButtonBox["\<\"Save Stop Time\"\>",
    Appearance->Automatic,
    ButtonFunction:>$CellContext`saveStopBoundary[],
    Evaluator->Automatic,
    Method->"Preemptive"]}], "}"}]], "Output",
 CellChangeTimes->{
  3.638661256230165*^9, 3.638662100473147*^9, 3.638662310094727*^9, 
   3.638662384347365*^9, 3.638662774347929*^9, 3.638663187977682*^9, 
   3.638663370685783*^9, 3.638663471126631*^9, 3.638666904020385*^9, {
   3.638667006472212*^9, 3.6386670306190243`*^9}, 3.6386672657027693`*^9, 
   3.638668211977564*^9, 3.6386682451258173`*^9, {3.6386682971333847`*^9, 
   3.6386683209703083`*^9}, 3.6386687880900517`*^9, 3.638668903086602*^9, 
   3.6386689640281*^9, 3.6386690729151287`*^9, 3.638669371815316*^9, {
   3.6386694757863626`*^9, 3.63866952429547*^9}, {3.638669830740303*^9, 
   3.6386698491900587`*^9}, 3.638670047318047*^9, 3.638670134785776*^9, 
   3.6386702880058413`*^9, 3.638670408407794*^9, {3.638670508128063*^9, 
   3.638670532361928*^9}, 3.638670963113089*^9, 3.638671133742345*^9, {
   3.638671183480856*^9, 3.638671204759144*^9}, 3.638671411696754*^9, {
   3.638671547260375*^9, 3.638671570753237*^9}, 3.638671660194805*^9, 
   3.638671718904862*^9, 3.638671859648642*^9, 3.63867190747836*^9, 
   3.638671968352046*^9, 3.6386720184528627`*^9}],

Cell[BoxData[
 DynamicBox[ToBoxes[
   DateListPlot[{$CellContext`bins, 
     $CellContext`makeStartMarkers[], 
     $CellContext`makeStopMarkers[]}, AspectRatio -> 1/5, PlotMarkers -> "*", 
    PlotStyle -> {Blue, Green, Red}, ImageSize -> 1000, Filling -> Bottom, 
    Joined -> False, PlotRange -> {{
       DateList[{
         Floor[$CellContext`startYear], 
         Floor[$CellContext`startMonth], 
         Floor[$CellContext`startDay]}], 
       DateList[{
         Floor[$CellContext`stopYear], 
         Floor[$CellContext`stopMonth], 
         Floor[$CellContext`stopDay]}]}, Automatic}], StandardForm],
  ImageSizeCache->{1000., {106., 111.}}]], "Output",
 CellChangeTimes->{
  3.638661256230165*^9, 3.638662100473147*^9, 3.638662310094727*^9, 
   3.638662384347365*^9, 3.638662774347929*^9, 3.638663187977682*^9, 
   3.638663370685783*^9, 3.638663471126631*^9, 3.638666904020385*^9, {
   3.638667006472212*^9, 3.6386670306190243`*^9}, 3.6386672657027693`*^9, 
   3.638668211977564*^9, 3.6386682451258173`*^9, {3.6386682971333847`*^9, 
   3.6386683209703083`*^9}, 3.6386687880900517`*^9, 3.638668903086602*^9, 
   3.6386689640281*^9, 3.6386690729151287`*^9, 3.638669371815316*^9, {
   3.6386694757863626`*^9, 3.63866952429547*^9}, {3.638669830740303*^9, 
   3.6386698491900587`*^9}, 3.638670047318047*^9, 3.638670134785776*^9, 
   3.6386702880058413`*^9, 3.638670408407794*^9, {3.638670508128063*^9, 
   3.638670532361928*^9}, 3.638670963113089*^9, 3.638671133742345*^9, {
   3.638671183480856*^9, 3.638671204759144*^9}, 3.638671411696754*^9, {
   3.638671547260375*^9, 3.638671570753237*^9}, 3.638671660194805*^9, 
   3.638671718904862*^9, 3.638671859648642*^9, 3.63867190747836*^9, 
   3.638671968352046*^9, 3.638672018455658*^9}],

Cell[BoxData[
 FrameBox[
  TagBox[GridBox[{
     {
      StyleBox["\<\"Start points\"\>",
       StripOnInput->False,
       FontWeight->Bold], 
      StyleBox["\<\"Stop points\"\>",
       StripOnInput->False,
       FontWeight->Bold]},
     {
      DynamicBox[ToBoxes[
        Dataset[
         Map[{
           DateString[
            DateList[#], $CellContext`sqlDateFormat], 
           Button["Delete", 
            $CellContext`deleteBoundary[$CellContext`userId, \
$CellContext`tagId, 1, #]]}& , 
          Sort[$CellContext`startPoints]]], StandardForm],
       ImageSizeCache->{252., {25., 33.}}], 
      DynamicBox[ToBoxes[
        Dataset[
         Map[{
           DateString[
            DateList[#], $CellContext`sqlDateFormat], 
           Button["Delete", 
            $CellContext`deleteBoundary[$CellContext`userId, \
$CellContext`tagId, 2, #]]}& , 
          Sort[$CellContext`stopPoints]]], StandardForm],
       ImageSizeCache->{253., {25., 33.}}]}
    },
    AutoDelete->False,
    GridBoxAlignment->{"Columns" -> {{Left}}, "Rows" -> {{Baseline}}},
    GridBoxItemSize->{"Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}],
   "Grid"],
  StripOnInput->False]], "Output",
 CellChangeTimes->{
  3.638661256230165*^9, 3.638662100473147*^9, 3.638662310094727*^9, 
   3.638662384347365*^9, 3.638662774347929*^9, 3.638663187977682*^9, 
   3.638663370685783*^9, 3.638663471126631*^9, 3.638666904020385*^9, {
   3.638667006472212*^9, 3.6386670306190243`*^9}, 3.6386672657027693`*^9, 
   3.638668211977564*^9, 3.6386682451258173`*^9, {3.6386682971333847`*^9, 
   3.6386683209703083`*^9}, 3.6386687880900517`*^9, 3.638668903086602*^9, 
   3.6386689640281*^9, 3.6386690729151287`*^9, 3.638669371815316*^9, {
   3.6386694757863626`*^9, 3.63866952429547*^9}, {3.638669830740303*^9, 
   3.6386698491900587`*^9}, 3.638670047318047*^9, 3.638670134785776*^9, 
   3.6386702880058413`*^9, 3.638670408407794*^9, {3.638670508128063*^9, 
   3.638670532361928*^9}, 3.638670963113089*^9, 3.638671133742345*^9, {
   3.638671183480856*^9, 3.638671204759144*^9}, 3.638671411696754*^9, {
   3.638671547260375*^9, 3.638671570753237*^9}, 3.638671660194805*^9, 
   3.638671718904862*^9, 3.638671859648642*^9, 3.63867190747836*^9, 
   3.638671968352046*^9, 3.638672018514217*^9}]
}, Open  ]]
},
WindowSize->{1920, 1056},
WindowMargins->{{0, Automatic}, {Automatic, 0}},
FrontEndVersion->"10.1 for Linux x86 (64-bit) (March 23, 2015)",
StyleDefinitions->"Default.nb"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[CellGroupData[{
Cell[580, 22, 38822, 943, 4081, "Input"],
Cell[39405, 967, 4202, 109, 82, "Output"],
Cell[43610, 1078, 5732, 114, 59, "Output"],
Cell[49345, 1194, 1196, 18, 32, "Output"],
Cell[50544, 1214, 2822, 63, 42, "Output"],
Cell[53369, 1279, 2820, 63, 42, "Output"],
Cell[56192, 1344, 1743, 31, 232, "Output"],
Cell[57938, 1377, 2272, 52, 102, "Output"]
}, Open  ]]
}
]
*)

(* End of internal cache information *)
